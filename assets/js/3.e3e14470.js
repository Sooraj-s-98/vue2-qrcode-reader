(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{405:function(t,e,n){"use strict";n.d(e,"c",(function(){return H})),n.d(e,"a",(function(){return U})),n.d(e,"b",(function(){return W}));var a,r,o,i=n(501),c=(n(102),n(33),n(103),n(11),n(37)),s=n(79),u=n(111),d=(n(241),n(242),n(234),n(47)),l=n(46),f=n(224),h=n(221),v=n(531),m=(n(24),n(106),function(t){function e(){var t;return Object(l.a)(this,e),(t=Object(f.a)(this,e,["can't process cross-origin image"])).name="DropImageFetchError",t}return Object(h.a)(e,t),Object(d.a)(e)}(Object(v.a)(Error))),p=function(t){function e(){var t;return Object(l.a)(this,e),(t=Object(f.a)(this,e,["this browser has no Stream API support"])).name="StreamApiNotSupportedError",t}return Object(h.a)(e,t),Object(d.a)(e)}(Object(v.a)(Error)),b=function(t){function e(){var t;return Object(l.a)(this,e),(t=Object(f.a)(this,e,["camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP."])).name="InsecureContextError",t}return Object(h.a)(e,t),Object(d.a)(e)}(Object(v.a)(Error)),w=n(483),g=function(t){if(t.length>0){var e=Object(u.a)(t,1)[0],n=Object(u.a)(e.cornerPoints,4),a=n[0],r=n[1],o=n[2],i=n[3];return{content:e.rawValue,location:{topLeftCorner:a,topRightCorner:r,bottomRightCorner:o,bottomLeftCorner:i,topLeftFinderPattern:{},topRightFinderPattern:{},bottomLeftFinderPattern:{}},imageData:null}}return{content:null,location:null,imageData:null}},O=function(){var t=Object(s.a)(Object(c.a)().m((function t(e){var n;return Object(c.a)().w((function(t){for(;;)switch(t.n){case 0:if(!e.startsWith("http")||!1!==e.includes(location.host)){t.n=1;break}throw new m;case 1:return(n=document.createElement("img")).src=e,t.n=2,Object(w.a)(n,"load");case 2:return t.a(2,n)}}),t)})));return function(e){return t.apply(this,arguments)}}(),j=function(){var t=Object(s.a)(Object(c.a)().m((function t(e){var n,a;return Object(c.a)().w((function(t){for(;;)switch(t.n){case 0:return n=new BarcodeDetector({formats:["qr_code"]}),t.n=1,n.detect(e);case 1:return a=t.v,t.a(2,g(a))}}),t)})));return function(e){return t.apply(this,arguments)}}(),y=function(){var t=Object(s.a)(Object(c.a)().m((function t(e){var n,a,r;return Object(c.a)().w((function(t){for(;;)switch(t.n){case 0:return n=new BarcodeDetector({formats:["qr_code"]}),t.n=1,O(e);case 1:return a=t.v,t.n=2,n.detect(a);case 2:return r=t.v,t.a(2,g(r))}}),t)})));return function(e){return t.apply(this,arguments)}}(),D=n(454),k=(n(23),n(30),n(464),n(467),n(468),n(469),n(470),n(471),n(523)),x=n(524),C=n(525),S=n(526),R=n(446),L=(a=function(){switch(Object(R.c)(window).browser){case"chrome":Object(k.a)(window);break;case"firefox":Object(C.a)(window);break;case"edge":Object(x.a)(window);break;case"safari":Object(S.a)(window);break;default:throw new p}},r=!1,o=void 0,function(){return r||(o=a.apply(void 0,arguments),r=!0),o}),q={isActive:!1};function F(){if(q.isActive){q.videoEl.srcObject=null;var t,e=Object(D.a)(q.stream.getTracks());try{for(e.s();!(t=e.n()).done;){var n=t.value;q.stream.removeTrack(n),n.stop()}}catch(t){e.e(t)}finally{e.f()}q={isActive:!1}}}function P(){return(P=Object(s.a)(Object(c.a)().m((function t(e,n){var a,r,o,i,s,d,l,f,h,v,m,g;return Object(c.a)().w((function(t){for(;;)switch(t.n){case 0:if(i=n.constraints,s=n.torch,!0===window.isSecureContext){t.n=1;break}throw new b;case 1:if(void 0!==(null===(a=navigator)||void 0===a||null===(a=a.mediaDevices)||void 0===a?void 0:a.getUserMedia)){t.n=2;break}throw new p;case 2:return L(),t.n=3,navigator.mediaDevices.getUserMedia({audio:!1,video:i});case 3:return d=t.v,void 0!==e.srcObject?e.srcObject=d:void 0!==e.mozSrcObject?e.mozSrcObject=d:window.URL.createObjectURL?e.src=window.URL.createObjectURL(d):window.webkitURL?e.src=window.webkitURL.createObjectURL(d):e.src=d.id,t.n=4,Object(w.a)(e,"loadeddata");case 4:return t.n=5,Object(w.b)(500);case 5:return s&&(l=d.getVideoTracks(),f=Object(u.a)(l,1),h=f[0],h.getCapabilities().torch?h.applyConstraints({advanced:[{torch:!0}]}):console.warn("device does not support torch capability")),v=(q={videoEl:e,stream:d,isActive:!0}).stream.getVideoTracks(),m=Object(u.a)(v,1),g=m[0],t.a(2,null!==(r=null==g||null===(o=g.getCapabilities)||void 0===o?void 0:o.call(g))&&void 0!==r?r:{})}}),t)})))).apply(this,arguments)}var A=n(527),B={beforeMount:function(){window.BarcodeDetector=A.a},methods:{onDetect:function(t){var e=this;return Object(s.a)(Object(c.a)().m((function n(){var a,r;return Object(c.a)().w((function(n){for(;;)switch(n.p=n.n){case 0:return e.$emit("detect",t),n.p=1,n.n=2,t;case 2:a=n.v,null!==(r=a.content)&&e.$emit("decode",r),n.n=4;break;case 3:n.p=3,n.v;case 4:return n.a(2)}}),n,null,[[1,3]])})))()}}},M=n(78),$=Object(M.a)(B,void 0,void 0,!1,null,null,null).exports,_={name:"qrcode-stream",mixins:[$],props:{constraints:{type:Object,default:function(){return{facingMode:"environment"}}},paused:{type:Boolean,default:!1},torch:{type:Boolean,default:!1},track:{type:Function}},data:function(){return{cameraActive:!1,isMounted:!1,pauseFrameRef:null,trackingLayerRef:null,videoRef:null}},computed:{cameraSettings:function(){return{torch:this.torch,constraints:this.constraints,shouldStream:this.isMounted&&!this.paused}},shouldScan:function(){return this.cameraSettings.shouldStream&&this.cameraActive}},mounted:function(){this.isMounted=!0},watch:{cameraSettings:{handler:function(t){t.shouldStream?(this.videoRef=this.$refs.video,this.pauseFrameRef=this.$refs.pauseFrame,this.trackingLayerRef=this.$refs.trackingLayer,this.startCamera()):this.stopCamera()},deep:!0},shouldScan:function(t){t&&(this.clearCanvas(this.$refs.pauseFrame),this.clearCanvas(this.$refs.trackingLayer),this.startScanning())}},beforeDestroy:function(){F()},methods:{startCamera:function(){var t=this,e=function(t,e){return P.apply(this,arguments)}(this.videoRef,this.cameraSettings);this.$emit("init",e),e.then((function(e){t.isMounted?(t.cameraActive=!0,console.log("capabilities",e)):F()})).catch((function(e){t.$emit("error",e)}))},stopCamera:function(){var t=this.pauseFrameRef,e=t.getContext("2d"),n=this.videoRef;t.width=n.videoWidth,t.height=n.videoHeight,e.drawImage(n,0,0,n.videoWidth,n.videoHeight),F(),this.cameraActive=!1,this.$emit("camera-off")},startScanning:function(){var t=this;console.log("startScanning");!function(t,e){var n=new BarcodeDetector({formats:["qr_code"]}),a=e.detectHandler,r=e.locateHandler,o=e.minDelay,i=function(e){return function(){var u=Object(s.a)(Object(c.a)().m((function s(u){var d,l,f,h,v,m,p,b;return Object(c.a)().w((function(c){for(;;)switch(c.n){case 0:if(!(t.readyState>1)){c.n=3;break}if(d=e.lastScanned,l=e.contentBefore,f=e.locationBefore,!(u-d>=o)){c.n=2;break}return c.n=1,n.detect(t);case 1:h=c.v,v=g(h),m=v.content,p=v.location,b=v.imageData,null!==m&&m!==l&&a({content:m,location:p,imageData:b}),null===p&&null===f||r(h),window.requestAnimationFrame(i({lastScanned:u,contentBefore:null!=m?m:l,locationBefore:p})),c.n=3;break;case 2:window.requestAnimationFrame(i(e));case 3:return c.a(2)}}),s)})));return function(t){return u.apply(this,arguments)}}()};i({contentBefore:null,locationBefore:null,lastScanned:performance.now()})()}(this.$refs.video,{detectHandler:function(e){t.onDetect(Promise.resolve(e))},locateHandler:this.onLocate,minDelay:this.scanInterval})},onLocate:function(t){var e=this.$refs.trackingLayer,n=this.$refs.video;if(void 0!==e)if(t.length>0&&void 0!==this.track&&void 0!==n){var a=n.offsetWidth,r=n.offsetHeight,o=n.videoWidth,c=n.videoHeight,s=Math.max(a/o,r/c),u=o*s,d=c*s,l=u/o,f=d/c,h=(a-u)/2,v=(r-d)/2,m=function(t){var e=t.x,n=t.y;return{x:Math.floor(e*l),y:Math.floor(n*f)}},p=function(t){var e=t.x,n=t.y;return{x:Math.floor(e+h),y:Math.floor(n+v)}},b=t.map((function(t){var e=t.boundingBox,n=t.cornerPoints,a=p(m({x:e.x,y:e.y})),r=a.x,o=a.y,c=m({x:e.width,y:e.height}),s=c.x,u=c.y;return Object(i.a)(Object(i.a)({},t),{},{cornerPoints:n.map((function(t){return p(m(t))})),boundingBox:DOMRectReadOnly.fromRect({x:r,y:o,width:s,height:u})})}));e.width=n.offsetWidth,e.height=n.offsetHeight;var w=e.getContext("2d");this.track(b,w)}else this.clearCanvas(e)},repaintTrackingLayer:function(t,e,n){var a=this,r=e.getContext("2d");window.requestAnimationFrame((function(){e.width=displayWidth,e.height=displayHeight,a.trackRepaintFunction(coordinatesAdjusted,r)}))},clearCanvas:function(t){t.getContext("2d").clearRect(0,0,t.width,t.height)}}},H=(n(528),Object(M.a)(_,(function(){var t=this._self._c;return t("div",{staticClass:"qrcode-stream-wrapper"},[t("video",{ref:"video",staticClass:"qrcode-stream-camera",class:{"qrcode-stream-camera--hidden":!this.shouldScan},attrs:{autoplay:"",muted:"",playsinline:""},domProps:{muted:!0}}),this._v(" "),t("canvas",{directives:[{name:"show",rawName:"v-show",value:!this.shouldScan,expression:"!shouldScan"}],ref:"pauseFrame",staticClass:"qrcode-stream-camera"}),this._v(" "),t("canvas",{ref:"trackingLayer",staticClass:"qrcode-stream-overlay"}),this._v(" "),t("div",{staticClass:"qrcode-stream-overlay"},[this._t("default")],2)])}),[],!1,null,"a8b3d328",null).exports),E=n(76),T=(n(141),n(142),{name:"qrcode-capture",mixins:[$],methods:{onChangeInput:function(t){Object(E.a)(t.target.files).map(j).forEach(this.onDetect)}}}),U=Object(M.a)(T,(function(){return(0,this._self._c)("input",{attrs:{type:"file",name:"image",accept:"image/*",capture:"environment",multiple:""},on:{change:this.onChangeInput}})}),[],!1,null,null,null).exports,I={name:"qrcode-drop-zone",mixins:[$],methods:{onDragOver:function(t){this.$emit("dragover",t)},onDrop:function(t){var e=this,n=t.dataTransfer;this.onDragOver(!1);var a=Object(E.a)(n.files),r=n.getData("text/uri-list");a.forEach((function(t){e.onDetect(j(t))})),""!==r&&this.onDetect(y(r))}}},W=Object(M.a)(I,(function(){var t=this;return(0,t._self._c)("div",{on:{drop:function(e){return e.preventDefault(),e.stopPropagation(),t.onDrop.apply(null,arguments)},dragenter:function(e){return e.preventDefault(),e.stopPropagation(),t.onDragOver(!0)},dragleave:function(e){return e.preventDefault(),e.stopPropagation(),t.onDragOver(!1)},dragover:function(t){t.preventDefault(),t.stopPropagation()}}},[t._t("default")],2)}),[],!1,null,null,null).exports;var V={install:function(t){t.component("qrcode-stream",H),t.component("qrcode-capture",U),t.component("qrcode-drop-zone",W)}},z=null;"undefined"!=typeof window?z=window.Vue:"undefined"!=typeof global&&(z=global.Vue),z&&z.use(V)},484:function(t,e,n){},528:function(t,e,n){"use strict";n(484)}}]);